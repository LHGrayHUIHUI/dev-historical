# æ–‡æœ¬å‘å¸ƒæœåŠ¡

å¤šå¹³å°å†…å®¹å‘å¸ƒæœåŠ¡ï¼Œæ”¯æŒå¾®åšã€å¾®ä¿¡ã€æŠ–éŸ³ã€ä»Šæ—¥å¤´æ¡ã€ç™¾å®¶å·ç­‰ä¸»æµç¤¾äº¤åª’ä½“å¹³å°çš„ç»Ÿä¸€å‘å¸ƒç®¡ç†ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- **å¤šå¹³å°æ”¯æŒ**: æ”¯æŒ5ä¸ªä¸»æµå‘å¸ƒå¹³å°çš„ç»Ÿä¸€æ¥å£
- **æ™ºèƒ½è°ƒåº¦**: æ”¯æŒç«‹å³å‘å¸ƒå’Œå®šæ—¶å‘å¸ƒ
- **è´Ÿè½½å‡è¡¡**: æ™ºèƒ½è´¦å·é€‰æ‹©å’Œé…é¢ç®¡ç†
- **å®æ—¶ç›‘æ§**: ä»»åŠ¡çŠ¶æ€å®æ—¶è·Ÿè¸ªå’Œè¿›åº¦æ˜¾ç¤º
- **é‡è¯•æœºåˆ¶**: è‡ªåŠ¨é‡è¯•å¤±è´¥çš„å‘å¸ƒä»»åŠ¡
- **ç»Ÿè®¡åˆ†æ**: è¯¦ç»†çš„å‘å¸ƒæ•°æ®ç»Ÿè®¡å’Œåˆ†æ

## ğŸ“‹ æ”¯æŒçš„å¹³å°

| å¹³å° | çŠ¶æ€ | å†…å®¹ç±»å‹ | é™åˆ¶ |
|------|------|----------|------|
| å¾®åš | âœ… å®Œæ•´æ”¯æŒ | æ–‡æœ¬+å›¾ç‰‡ | 140å­—ç¬¦ |
| å¾®ä¿¡å…¬ä¼—å· | âœ… åŸºç¡€æ”¯æŒ | å›¾æ–‡æ¶ˆæ¯ | 20000å­—ç¬¦ |
| æŠ–éŸ³ | âœ… åŸºç¡€æ”¯æŒ | çŸ­è§†é¢‘+æ–‡æœ¬ | 2200å­—ç¬¦ |
| ä»Šæ—¥å¤´æ¡ | âœ… åŸºç¡€æ”¯æŒ | æ–‡ç« +å›¾ç‰‡ | 5000å­—ç¬¦ |
| ç™¾å®¶å· | âœ… åŸºç¡€æ”¯æŒ | æ–‡ç« +è§†é¢‘ | 8000å­—ç¬¦ |

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Vue3 å‰ç«¯     â”‚    â”‚   FastAPI åç«¯  â”‚    â”‚   å¹³å°é€‚é…å™¨     â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ å‘å¸ƒç®¡ç†      â”‚â—„â”€â”€â–ºâ”‚ â€¢ ä»»åŠ¡ç®¡ç†      â”‚â—„â”€â”€â–ºâ”‚ â€¢ å¾®åšé€‚é…å™¨     â”‚
â”‚ â€¢ çŠ¶æ€ç›‘æ§      â”‚    â”‚ â€¢ è´¦å·ç®¡ç†      â”‚    â”‚ â€¢ å¾®ä¿¡é€‚é…å™¨     â”‚
â”‚ â€¢ ç»Ÿè®¡åˆ†æ      â”‚    â”‚ â€¢ ç»Ÿè®¡åˆ†æ      â”‚    â”‚ â€¢ æŠ–éŸ³é€‚é…å™¨     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–²
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   æ•°æ®å­˜å‚¨      â”‚
                    â”‚                 â”‚
                    â”‚ â€¢ PostgreSQL    â”‚
                    â”‚ â€¢ Redis         â”‚
                    â”‚ â€¢ RabbitMQ      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯
- **æ¡†æ¶**: FastAPI 0.104+
- **è¯­è¨€**: Python 3.11+
- **æ•°æ®åº“**: PostgreSQL 15+
- **ç¼“å­˜**: Redis 7+
- **ä»»åŠ¡é˜Ÿåˆ—**: Celery + RabbitMQ
- **ORM**: SQLAlchemy 2.0 (å¼‚æ­¥)

### å‰ç«¯
- **æ¡†æ¶**: Vue 3 + TypeScript
- **çŠ¶æ€ç®¡ç†**: Pinia
- **UIç»„ä»¶**: Element Plus
- **æ„å»ºå·¥å…·**: Vite

### åŸºç¡€è®¾æ–½
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **ç¼–æ’**: Kubernetes
- **ç›‘æ§**: Prometheus + Grafana
- **æ—¥å¿—**: ELK Stack

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd Historical Text Project/services/text-publishing-service

# å¤åˆ¶ç¯å¢ƒå˜é‡é…ç½®
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®æ•°æ®åº“è¿æ¥ç­‰
vim .env
```

### 2. ä½¿ç”¨Docker Composeå¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose -f ../../docker-compose.dev.yml up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose -f ../../docker-compose.dev.yml ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f ../../docker-compose.dev.yml logs -f text-publishing-service
```

### 3. æœ¬åœ°å¼€å‘æ¨¡å¼

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨æ•°æ®åº“å’ŒRedisï¼ˆä½¿ç”¨Dockerï¼‰
docker-compose -f ../../docker-compose.dev.yml up -d postgres redis rabbitmq

# è¿è¡Œæ•°æ®åº“è¿ç§»
alembic upgrade head

# å¯åŠ¨æœåŠ¡
python -m src.main
```

### 4. åˆå§‹åŒ–æ•°æ®

```bash
# è®¿é—®å¼€å‘æ•°æ®åˆå§‹åŒ–æ¥å£ï¼ˆä»…å¼€å‘æ¨¡å¼ï¼‰
curl -X POST http://localhost:8080/dev/init-data
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ | å¿…å¡« |
|------|------|--------|------|
| `DATABASE_URL` | PostgreSQLè¿æ¥å­—ç¬¦ä¸² | - | âœ… |
| `REDIS_URL` | Redisè¿æ¥å­—ç¬¦ä¸² | - | âœ… |
| `WEIBO_API_KEY` | å¾®åšAPIå¯†é’¥ | - | å¯é€‰ |
| `WECHAT_APP_ID` | å¾®ä¿¡APP ID | - | å¯é€‰ |
| `DEBUG` | è°ƒè¯•æ¨¡å¼ | `false` | âŒ |

### å¹³å°APIé…ç½®

æ¯ä¸ªå¹³å°éƒ½éœ€è¦ç›¸åº”çš„APIå‡­æ®ï¼š

```bash
# å¾®åšé…ç½®
WEIBO_API_KEY=your_api_key
WEIBO_API_SECRET=your_api_secret

# å¾®ä¿¡é…ç½®
WECHAT_APP_ID=your_app_id
WECHAT_APP_SECRET=your_app_secret
```

## ğŸ“š APIæ–‡æ¡£

æœåŠ¡å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®APIæ–‡æ¡£ï¼š

- **Swagger UI**: http://localhost:8080/docs
- **ReDoc**: http://localhost:8080/redoc

### ä¸»è¦æ¥å£

#### åˆ›å»ºå‘å¸ƒä»»åŠ¡
```http
POST /api/v1/publish
Content-Type: application/json

{
    "content": "å‘å¸ƒå†…å®¹",
    "platforms": ["weibo", "douyin"],
    "title": "æ ‡é¢˜",
    "scheduled_at": "2024-01-01T12:00:00Z"
}
```

#### æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€
```http
GET /api/v1/publish/tasks/{task_uuid}/status
```

#### è·å–ä»»åŠ¡åˆ—è¡¨
```http
GET /api/v1/publish/tasks?status=published&page=1&page_size=20
```

#### è·å–ç»Ÿè®¡æ•°æ®
```http
GET /api/v1/publish/statistics?start_date=2024-01-01&end_date=2024-01-31
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/test_api.py -v

# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=src --cov-report=html --cov-report=term
```

### æµ‹è¯•è¦†ç›–ç‡

ç›®æ ‡ï¼š80%ä»¥ä¸Šçš„ä»£ç è¦†ç›–ç‡

```bash
# æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š
open htmlcov/index.html
```

## ğŸš€ éƒ¨ç½²

### Dockeréƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t text-publishing-service .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name text-publishing-service \
  -p 8080:8080 \
  --env-file .env \
  text-publishing-service
```

### Kuberneteséƒ¨ç½²

```bash
# éƒ¨ç½²åˆ°K8sé›†ç¾¤
kubectl apply -f k8s/
```

## ğŸ“Š ç›‘æ§

### å¥åº·æ£€æŸ¥

- **åŸºç¡€å¥åº·**: `GET /health/`
- **å°±ç»ªæ£€æŸ¥**: `GET /health/ready`
- **PrometheusæŒ‡æ ‡**: `GET /health/metrics`

### æ—¥å¿—

æœåŠ¡ä½¿ç”¨ç»“æ„åŒ–JSONæ—¥å¿—ï¼š

```bash
# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker logs text-publishing-service

# å®æ—¶ç›‘æ§æ—¥å¿—
docker logs -f text-publishing-service
```

## ğŸ”’ å®‰å…¨

### APIè®¤è¯

æœåŠ¡ä½¿ç”¨JWT Bearer Tokenè®¤è¯ï¼š

```http
Authorization: Bearer <your-jwt-token>
```

### æ•°æ®åŠ å¯†

- æ•æ„Ÿçš„è´¦å·å‡­æ®åœ¨æ•°æ®åº“ä¸­åŠ å¯†å­˜å‚¨
- æ‰€æœ‰APIé€šä¿¡å»ºè®®ä½¿ç”¨HTTPS
- æ”¯æŒCORSè·¨åŸŸè®¿é—®æ§åˆ¶

## ğŸ¤ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ config/          # é…ç½®ç®¡ç†
â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”œâ”€â”€ services/        # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”œâ”€â”€ controllers/     # APIæ§åˆ¶å™¨
â”œâ”€â”€ adapters/        # å¹³å°é€‚é…å™¨
â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â””â”€â”€ main.py         # åº”ç”¨å…¥å£

tests/              # æµ‹è¯•æ–‡ä»¶
migrations/         # æ•°æ®åº“è¿ç§»
docs/              # æ–‡æ¡£
```

### æ·»åŠ æ–°å¹³å°

1. åˆ›å»ºå¹³å°é€‚é…å™¨ï¼š`src/adapters/new_platform_adapter.py`
2. ç»§æ‰¿`PlatformAdapter`åŸºç±»
3. å®ç°è®¤è¯å’Œå‘å¸ƒæ–¹æ³•
4. åœ¨é…ç½®ä¸­æ·»åŠ å¹³å°ä¿¡æ¯
5. ç¼–å†™æµ‹è¯•ç”¨ä¾‹

### ä»£ç è§„èŒƒ

```bash
# æ ¼å¼åŒ–ä»£ç 
black src/ tests/
isort src/ tests/

# ä»£ç æ£€æŸ¥
flake8 src/ tests/
mypy src/
```

## ğŸ› é—®é¢˜æ’æŸ¥

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥æ•°æ®åº“æœåŠ¡çŠ¶æ€
   docker-compose ps postgres
   # æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²é…ç½®
   echo $DATABASE_URL
   ```

2. **Redisè¿æ¥å¤±è´¥**
   ```bash
   # æ£€æŸ¥RedisæœåŠ¡
   docker-compose ps redis
   # æµ‹è¯•è¿æ¥
   redis-cli -u $REDIS_URL ping
   ```

3. **å¹³å°APIè®¤è¯å¤±è´¥**
   - æ£€æŸ¥APIå¯†é’¥é…ç½®
   - ç¡®è®¤è´¦å·æƒé™å’Œé…é¢

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
export DEBUG=true
python -m src.main
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-01)
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… æ”¯æŒ5ä¸ªä¸»æµå‘å¸ƒå¹³å°
- ğŸš€ å¤šå¹³å°ç»Ÿä¸€å‘å¸ƒæ¥å£
- ğŸ“Š å®æ—¶çŠ¶æ€ç›‘æ§å’Œç»Ÿè®¡

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

1. Forké¡¹ç›®
2. åˆ›å»ºfeatureåˆ†æ”¯ï¼š`git checkout -b feature/new-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -am 'Add new feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/new-feature`
5. æäº¤Pull Request

## ğŸ“ æ”¯æŒ

å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤Issueï¼š[GitHub Issues](https://github.com/your-repo/issues)
- é‚®ä»¶ï¼šsupport@yourcompany.com

---

**ğŸ“ˆ ä¸ºå†å²æ–‡æœ¬ä¼˜åŒ–é¡¹ç›®æä¾›å¼ºå¤§çš„å¤šå¹³å°å‘å¸ƒèƒ½åŠ›ï¼**